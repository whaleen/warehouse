<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Truck Staging Status</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<link href="/scanbyeachstaging/resources/style/common.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link href="/scanbyeachstaging/resources/style/colorbox.css" rel="stylesheet">
<link href="/scanbyeachstaging/resources/style/orientation.css" rel="stylesheet"> 
 <link href="/scanbyeachstaging/resources/style/bootstrap-datetimepicker.min.css" rel="stylesheet">
 <script src="/scanbyeachstaging/resources/js/moment.js"></script>
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">  
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/gasparesganga-jquery-loading-overlay@1.5.4/src/loadingoverlay.min.js"></script>
<script src="/scanbyeachstaging/resources/js/bootstrap-datetimepicker.js"></script>
<style>
.circle {
    border-radius: 50%;
    width: 34px;
    height: 34px;
    padding: 7px;
    background: #fff;
    text-align: center;
    font: 16px Arial, sans-serif;
	margin-left: 18px;
  }
.table-bordered td, .table-bordered th {
    border: 1.5px solid #1d1b1b;
}
.circle1 {
		border-radius: 50%;
		width: 36px;
		height: 35px;
		padding: 2px;
		background: #fff;
		text-align: left;
		font: 16px Arial, sans-serif;
		margin-left: 8%;
  }

	/* Style the buttons that are used to open and close the accordion panel */
	.accordion {
	  background-color: #3b73b9;
	  color: #fff;
	  height: 30px;
	  cursor: pointer;
	  padding: 14px;
	  width: 81%;
	  text-align: left;
	  border: none;
	  outline: none;
	  transition: 0.4s;
	}
	
 
	.active, .accordion:hover {
	  background-color: #0f3657; 
	} 
	
	.panel {	 
     padding: 0 18px;
	  background-color: white;
	  display: none;
	  overflow: hidden;
	 -webkit-box-shadow: 0 1px 1px rgb(0 0 0 / 0%) !important;
	 box-shadow: 0 1px 1px rgb(0 0 0 / 0%) !important;
	}
	
	.panel.table-responsive.table-bordered td, .panel.table-bordered th {
     border: 2px solid;
    }
	.f14 {
		font-size: 14px !important;
	}
	.w-18{
		width:18% !important;
	}
	.w-35{
		width:35% !important;
	}
</style>

</head>
<body>
<nav class="navbar navbar-default navbar-fixed-top">
	<div class="col-xs-3">
	<label for="sel1">INV ORG:</label>
	<select class="form-control" id="dmsLoc" style="width: 40%;" name="dmsLoc">
		<option value="">....</option>
		
			<option value="19SU">9SU</option>					
		
	</select>
	</div>
	<div class="col-xs-3">
		<label for="sel1">DELIVERY DATE:</label>
	<div class="input-group date" id="datetimepicker1" style="width: 66%;">
	 <input type="text" class="form-control" id="orderDate" name="orderDate">
	 <span class="input-group-addon">
	     <span class="glyphicon glyphicon-calendar"></span>
	 </span>
	</div>
	</div>
	<div class="col-xs-3" style="text-align :center">
		<label for="sel1">Time :</label>
		<span><b><i class="time">02-7-2026  11:56:26 PM Eastern DLT</i></b></span>
	</div>
	<div class="col-xs-3" style="padding: 23px; text-align :center">
		<button style="width: 50%; padding: 7px;font-size: 16px;border-radius: 15px;" type="button" id="refreshpage" class="btn btn-primary btn-sm">
			<span class="glyphicon glyphicon-refresh"></span> Refresh
		</button>
	</div>
	 
</nav>
<br><br>
<!--
<div class="container">
	<div class="panel-body">
		<div class="row" style="margin-bottom: -17px;margin-up: 10px;">
		<div class="col-xs-3">
			<label for="sel1">INV ORG :</label>
		  <select class="form-control" id="dmsLoc" name="dmsLoc">
		  	<option value="">....</option>
		  	
					<option value="19SU">9SU</option>					
				
			</select>
		</div>
		 <div class="col-xs-3">
		  	<label for="sel1">Date:</label>
		    <div class='input-group date' id='datetimepicker1'>
             <input type='text' class="form-control" id="orderDate" name="orderDate"  />
             <span class="input-group-addon">
                 <span class="glyphicon glyphicon-calendar"></span>
             </span>
         </div>
         </div>
         <div class="col-xs-3" style="text-align :center">
		  	<label for="sel1">Time :</label>
		    	<span><b><i class="time">09:26 Eastern DLT</i></b></span>
		  </div>
		  <div class="col-xs-3" style="padding: 23px; text-align :center">
		  	<button type="button" id="refreshpage" class="btn btn-primary btn-sm" >
		  		<span class="glyphicon glyphicon-refresh"></span> Refresh
		  	</button>
		  </div>
		  </div>
         
		  
	</div>
</div>

<br> -->

	<div class="container" id="countdiv">
		<div class="row">
			<div class="col-12">
				<table class="table table-image" style="width: 31%;margin-left: auto;margin-right: auto;">
					<tbody>
						<tr> <td colspan="3" style="text-align: center;border: 0px solid #1d1b1b;"><span class="truckcount"><u><b> 0 TOTAL TRUCKS </b></u></span>&nbsp;&nbsp;<span class="filterbutton" style="display: none;"><button type="button" id="refreshpage" onclick="onchangedata('ALL');" class="btn btn-sm">
				  		<span class="fa-solid fa-filter-circle-xmark"></span> Remove Filter
					  	</button></span></td></tr>
						<tr style="border: 0px solid #1d1b1b;">
						<td class="w-25" onclick="filtertruck('green');" style="cursor: pointer;"><img src="/scanbyeachstaging/resources/images/green Truck.png" class="img-fluid " alt="Green Truck"><br><div class="circle greencount" onclick="filtertruck('green');" style="border: 2px solid #439f24; color: #439f24;cursor: pointer;">0</div><div style="margin-left: 8px;">Scanned<br><span>No Issues</span></div></td>
						<td class="w-25" onclick="filtertruck('orange');" style="cursor: pointer;"><img src="/scanbyeachstaging/resources/images/orange Truck.png" class="img-fluid " alt="Green Truck"><br><div class="circle orangecount" onclick="filtertruck('orange');" style="border: 2px solid #da8d8d; color: #da8d8d;cursor: pointer;">0</div><div style="margin-left: 8px;">Scanned<br><span>With Issues</span></div></td>
						<td class="w-25" onclick="filtertruck('grey');" style="cursor: pointer;"><img src="/scanbyeachstaging/resources/images/grey Truck.png" class="img-fluid " alt="Green Truck"><br><div class="circle greycount" onclick="filtertruck('grey');" style="border: 2px solid #938a8a; color: #938a8a;cursor: pointer;">0</div><div style="margin-left: 8px;">&nbsp;&nbsp;&nbsp;Scan<br><span>Pending</span></div></td>
						</tr>
					</tbody>
				</table>   
			</div>
	  </div>
	</div>
	
	<div class="truckdata"></div>
	<form name="ReportForm">
	
		<input type="hidden" name="truckNumber" id="truckNumber" value="ALL"> 
		<input type="hidden" name="dmsLoc" id="dmsLocreport" value=""> 
		<input type="hidden" name="deliveryDate" id="deliveryDate" value="">
		<input type="hidden" name="truck" id="truckarray" value="">
		<div class="report" style="text-align: center; cursor: pointer; display: none;"><b><a href="#">Click HERE </a>to download an Excel version of the Staging Scan Report</b><div>
	
	



<script>

$(function () {
	//$('#countdiv').hide();
	$('.filterbutton').hide();
    $('#datetimepicker1').datetimepicker({
    	format : 'MM-DD-YYYY',
    	maxDate: moment().add(8, 'd').toDate()
    });
    var todate= new Date();
    var time = todate.toLocaleString('en-US', { timeZone: 'America/New_York' });
    var curtime=time.split(",");
    var curdate=curtime[0].split('/');
    curdate=curdate[0].length?"0"+curdate[0]+"-"+curdate[1]+"-"+curdate[2]:curdate[0]+"-"+curdate[1]+"-"+curdate[2];
    $('.time').text( curdate +" "+curtime[1]+" Eastern DLT");
    $('.report').hide();
    //add next day to datepicker
   	var date =  moment().add(1, 'd').toDate();
   	var formattedDate = moment(date).format('MM-DD-YYYY');
    $('#orderDate').val(formattedDate);
});
var truckresponse='';
$(".selected_date").blur(function(){
	onchangedata('ALL');
 });

function refreshpage(){
	location.reload();
};

$('#dmsLoc').unbind().change(function(){
	onchangedata('ALL');
});
$("#orderDate").unbind().blur(function(){
	onchangedata('ALL');
});
$("#refreshpage").unbind().click(function(){
	onchangedata('ALL');
});

function onchangedata(param) {
	var valid=false;
	filtertype="";
	var dataType=param;
	if((typeof($('#dmsLoc').val()) != "undefined" && $('#dmsLoc').val() != "") && (typeof($('#orderDate').val()) != "undefined" && $('#orderDate').val() != "")) {
		var dmsLoc = $('#dmsLoc').val();
		var deliverdate= $('#orderDate').val();
		var orderDate=deliverdate.split('-');
		orderDate = orderDate[1]+'-'+orderDate[0]+'-'+orderDate[2];
		valid = true;
	}
	
	if(valid) {
			$('.truckdata').html("");
			$('.greencount').text("0");
	 		$('.orangecount').text("0");
	 		$('.greycount').text("0");
	 		$('.truckcount').html("<u><b> 0 TOTAL TRUCKS </b></u>");
	 		$('.report').hide();
		   $.LoadingOverlay("show");
		   var url= "https://54qe2qx889.execute-api.us-east-1.amazonaws.com/prd/truckdetails?dmsLoc="+dmsLoc+"&orderDate="+orderDate;
		   
		   // Instantiate an new XHR Object
       		const xhr = new XMLHttpRequest();
	        // Open an obejct (GET/POST, PATH,
	        // ASYN-TRUE/FALSE)
	        xhr.open("GET", url, true);
	        // When response is ready
	        xhr.onload = function () {
	            if (this.status === 200) {
		                truckresponse=JSON.parse(this.responseText);;
						displayTruckdata(truckresponse,dataType);
						console.log(truckresponse);
		            }
		            else {
		                $.LoadingOverlay("hide");
		            }
		        }
		        // At last send the request
		        xhr.send();
        
		   /* $.ajax({
			  type: 'GET',
			  url:url,
			  crossDomain: true,
			  dataType: 'jsonp',
	          contentType: 'application/json; charset=utf-8',
	          xhrFields: {
			    withCredentials: false
			  },
			  headers: {
			    'accept': 'application/json',
			    'Access-Control-Allow-Credentials' : true,
			    'Access-Control-Allow-Origin':'*',
			    'Access-Control-Allow-Methods':'GET',
			    'Access-Control-Allow-Headers':'application/json',
			  },
			  success: function(response) {
			   truckresponse=response;
			   displayTruckdata(truckresponse,dataType);
			   console.log(response);
			  },error: function (jqXHR, exception) {
				  $.LoadingOverlay("hide");
			  }
			}); */
	}
};
var truckArray=[];
var greentruckArray=[];
var orangetruckArray=[];
var greytruckArray=[];
var filtertype="";
function displayTruckdata(truckresponse,dataType) {
	var responseTruck="";
	var data = truckresponse.dict;
	if(typeof(data) !="undefined" && data != null && data.length > 0) {
		var scannedcount=0;
		var pendingcount=0;
		var greycount=0;
		truckArray=[];
		greentruckArray=[];
		orangetruckArray=[];
		greytruckArray=[];
		if(dataType=='ALL') {
			$('.filterbutton').hide();
			for (var j=0; j<data.length; j++) {
	 			var status="";
	 			var param={'truckname':data[j].truck_name};
	 			var trcukscan="";
	 			truckArray.push(data[j].truck_name)
	 			if(data[j].truck_status == "SCANNED") {
	 				trcukscan =data[j].truck_status;
	 				greentruckArray.push(data[j].truck_name);
	 				scannedcount++;
	 				status ='<span class="circle1 scannedTruck" style="display: inline-flex;border: 2px solid #439f24; color: #439f24;"><img src="/scanbyeachstaging/resources/images/green tick.png" class="img-fluid " alt="Green tick"></span>&nbsp;';
	 			}else if(data[j].truck_status == "SCANNED WITH ISSUES" || data[j].truck_status == "MANIFEST CHANGE AFTER SCAN") {
	 				trcukscan ="SCANNED WITH ISSUES";
	 				orangetruckArray.push(data[j].truck_name);
	 				pendingcount++;
 					status ='<span class="circle1 pendingTruck" style="display: inline-flex;border: 2px solid #da8d8d; color: #da8d8d;"><img src="/scanbyeachstaging/resources/images/orange tick.png" class="img-fluid " alt="Orange tick"></span>&nbsp;';
	 			}else if(data[j].truck_status == "MANIFESTING CHANGE - AFTER SCANNED WITH ISSUES" || data[j].truck_status == "MANIFESTING CHANGE - AFTER SCANNED" ) {
	 				trcukscan =data[j].truck_status;
	 				orangetruckArray.push(data[j].truck_name);
	 				pendingcount++;
 					status ='<span class="circle1 pendingTruck" style="display: inline-flex;border: 2px solid #da8d8d; color: #da8d8d;"><img src="/scanbyeachstaging/resources/images/orange tick.png" class="img-fluid " alt="Orange tick"></span>&nbsp;';
	 			}else {
	 				trcukscan =data[j].truck_status;
	 				greytruckArray.push(data[j].truck_name);
	 				greycount++;
	 				status ='<span class="circle1 notscannedTruck" style="display: inline-flex;border: 2px solid #938a8a; color: #938a8a;"><img src="/scanbyeachstaging/resources/images/greymark.png" class="img-fluid " alt="Grey tick"></span>&nbsp;';
	 			}
	 			responseTruck +=status;
	 			responseTruck +="<table class='table-bordered accordion head_"+data[j].truck_name+"' style='display:inline-table;border-radius: 15px;' onclick='onclickTruckItemdata("+JSON.stringify(param)+")'>";
	 			//responseTruck +="<table class='table-bordered accordion' style='display:inline-table;border-radius: 10px;'>";
	 			responseTruck +='<td style="border: 1px solid #fff;" class="w-18"><b>&nbsp; TRUCK :</b> <span class="f14"><i>'+data[j].truck_name+'</i></span> </td>';
	 			responseTruck +='<td style="border: 1px solid #fff;" class="w-35"><b>&nbsp; DRIVER :</b> <span class="f14"><i>'+data[j].driver_name+' ('+data[j].driver_number+')</i></span> </td>';
	 			if(data[j].truck_status == "MANIFEST CHANGE AFTER SCAN")
		 			responseTruck +='<td style="border: 1px solid #fff;"><b>&nbsp; STATUS :</b> <span class="f14"><i>'+trcukscan+'&nbsp;'+data[j].truck_scan_date+'</i><br></span> <span>&nbsp;<span style="color:#ff0000">**</span>MANIFEST CHANGE AFTER SCAN - please rescan<span style="color:#ff0000">**</span></span></td>';
	 			else
		 			responseTruck +='<td style="border: 1px solid #fff;"><b>&nbsp; STATUS :</b> <span class="f14"><i>'+trcukscan+'&nbsp;'+data[j].truck_scan_date+'</i></span></td>';	 		
	 			responseTruck +='<td style="border: 1px solid #fff;text-align:center; width:25px;"><span class="arrowicon"><i style="margin-right: 5px;" class="fa fa-angle-down"></i></span></td></table>';
	 			responseTruck +='<div class="'+data[j].truck_name+'"></div>';
	 		}
		}else if(dataType=='ScannedFilter') {
			for (var j=0; j<data.length; j++) {
	 			var status="";
	 			var param={'truckname':data[j].truck_name};
	 			truckArray.push(data[j].truck_name)
	 			if(data[j].truck_status == "SCANNED") {
	 				greentruckArray.push(data[j].truck_name);
	 				scannedcount++;
	 				status ='<span class="circle1 scannedTruck" style="display: inline-flex;border: 2px solid #439f24; color: #439f24;"><img src="/scanbyeachstaging/resources/images/green tick.png" class="img-fluid " alt="Green tick"></span>&nbsp;';
	 				responseTruck +=status;
		 			responseTruck +="<table class='table-bordered accordion head_"+data[j].truck_name+"' style='display:inline-table;border-radius: 15px;' onclick='onclickTruckItemdata("+JSON.stringify(param)+")'>";
		 			//responseTruck +="<table class='table-bordered accordion' style='display:inline-table;border-radius: 10px;'>";
		 			responseTruck +='<td style="border: 1px solid #fff;" class="w-18"><b>&nbsp; TRUCK :</b> <span class="f14"><i>'+data[j].truck_name+'</i></span> </td>';
		 			responseTruck +='<td style="border: 1px solid #fff;" class="w-35"><b>&nbsp; DRIVER :</b> <span class="f14"><i>'+data[j].driver_name+' ('+data[j].driver_number+')</i></span> </td>';
		 			responseTruck +='<td style="border: 1px solid #fff;"><b>&nbsp; STATUS :</b> <span class="f14"><i>'+data[j].truck_status+'&nbsp;'+data[j].truck_scan_date+'</i></span> </td>';
		 			responseTruck +='<td style="border: 1px solid #fff;text-align:center; width:25px;"><span class="arrowicon"><i style="margin-right: 5px;" class="fa fa-angle-down"></i></span></td></table>';
		 			responseTruck +='<div class="'+data[j].truck_name+'"></div>';
	 			}else if(data[j].truck_status == "SCANNED WITH ISSUES"|| data[j].truck_status == "MANIFEST CHANGE AFTER SCAN" || data[j].truck_status == "MANIFESTING CHANGE - AFTER SCANNED") {
	 				trcukscan ="SCANNED WITH ISSUES";
	 				orangetruckArray.push(data[j].truck_name);
	 				pendingcount++;
	 			}else {
	 				greytruckArray.push(data[j].truck_name);
	 				greycount++;
	 			}
	 		//	$.LoadingOverlay("hide");
 			//	$('.report').show();
	 		}
		} else if(dataType=='NotScannedFilter') {
			for (var j=0; j<data.length; j++) {
	 			var status="";
	 			var param={'truckname':data[j].truck_name};
	 			truckArray.push(data[j].truck_name)
	 			if(data[j].truck_status == "SCANNED") {
	 				greentruckArray.push(data[j].truck_name);
	 				scannedcount++;
	 			}else if(data[j].truck_status == "SCANNED WITH ISSUES"|| data[j].truck_status == "MANIFEST CHANGE AFTER SCAN" || data[j].truck_status == "MANIFESTING CHANGE - AFTER SCANNED" ) {
	 				trcukscan ="SCANNED WITH ISSUES";
	 				orangetruckArray.push(data[j].truck_name);
	 				pendingcount++;
	 				status ='<span class="circle1 pendingTruck" style="display: inline-flex;border: 2px solid #da8d8d; color: #da8d8d;"><img src="/scanbyeachstaging/resources/images/orange tick.png" class="img-fluid " alt="Green tick"></span>&nbsp;';
	 				responseTruck +=status;
		 			responseTruck +="<table class='table-bordered accordion head_"+data[j].truck_name+"' style='display:inline-table;border-radius: 15px;' onclick='onclickTruckItemdata("+JSON.stringify(param)+")'>";
		 			//responseTruck +="<table class='table-bordered accordion' style='display:inline-table;border-radius: 10px;'>";
		 			responseTruck +='<td style="border: 1px solid #fff;" class="w-18"><b>&nbsp; TRUCK :</b> <span class="f14"><i>'+data[j].truck_name+'</i></span> </td>';
		 			responseTruck +='<td style="border: 1px solid #fff;" class="w-35"><b>&nbsp; DRIVER :</b> <span class="f14"><i>'+data[j].driver_name+' ('+data[j].driver_number+')</i></span> </td>';
		 			if(data[j].truck_status == "MANIFEST CHANGE AFTER SCAN")
			 			responseTruck +='<td style="border: 1px solid #fff;"><b>&nbsp; STATUS :</b> <span class="f14"><i>'+trcukscan+'&nbsp;'+data[j].truck_scan_date+'</i><br></span> <span>&nbsp;<span style="color:#ff0000">**</span>MANIFEST CHANGE AFTER SCAN - please rescan<span style="color:#ff0000">**</span></span></td>';
		 			else
			 			responseTruck +='<td style="border: 1px solid #fff;"><b>&nbsp; STATUS :</b> <span class="f14"><i>'+trcukscan+'&nbsp;'+data[j].truck_scan_date+'</i></span></td>';
		 			responseTruck +='<td style="border: 1px solid #fff;text-align:center; width:25px;"><span class="arrowicon"><i style="margin-right: 5px;" class="fa fa-angle-down"></i></span></td></table>';
		 			responseTruck +='<div class="'+data[j].truck_name+'"></div>';
	 			}else {
	 				greytruckArray.push(data[j].truck_name);
	 				greycount++;
	 			}
	 		//	$.LoadingOverlay("hide");
 			//	$('.report').show();
	 		}
		}else if(dataType=='PendingFilter'){
			for (var j=0; j<data.length; j++) {
	 			var status="";
	 			var param={'truckname':data[j].truck_name};
	 			truckArray.push(data[j].truck_name)
	 			if(data[j].truck_status == "SCANNED") {
	 				greentruckArray.push(data[j].truck_name);
	 				scannedcount++;
	 			}else if(data[j].truck_status == "SCANNED WITH ISSUES" || data[j].truck_status == "MANIFEST CHANGE AFTER SCAN" || data[j].truck_status == "MANIFESTING CHANGE - AFTER SCANNED" ) {
	 				orangetruckArray.push(data[j].truck_name);
	 				pendingcount++;
	 			}else {
	 				greytruckArray.push(data[j].truck_name);
	 				greycount++;
	 				status ='<span class="circle1 notscannedTruck" style="display: inline-flex;border: 2px solid #938a8a; color: #938a8a;"><img src="/scanbyeachstaging/resources/images/greymark.png" class="img-fluid " alt="Green tick"></span>&nbsp;';
	 				responseTruck +=status;
		 			responseTruck +="<table class='table-bordered accordion head_"+data[j].truck_name+"' style='display:inline-table;border-radius: 15px;' onclick='onclickTruckItemdata("+JSON.stringify(param)+")'>";
		 			//responseTruck +="<table class='table-bordered accordion' style='display:inline-table;border-radius: 10px;'>";
		 			responseTruck +='<td style="border: 1px solid #fff;" class="w-18"><b>&nbsp; TRUCK :</b> <span class="f14"><i>'+data[j].truck_name+'</i></span> </td>';
		 			responseTruck +='<td style="border: 1px solid #fff;" class="w-35"><b>&nbsp; DRIVER :</b> <span class="f14"><i>'+data[j].driver_name+' ('+data[j].driver_number+')</i></span> </td>';
		 			responseTruck +='<td style="border: 1px solid #fff;"><b>&nbsp; STATUS :</b> <span class="f14"><i>'+data[j].truck_status+'&nbsp;'+data[j].truck_scan_date+'</i></span> </td>';
		 			responseTruck +='<td style="border: 1px solid #fff;text-align:center; width:25px;"><span class="arrowicon"><i style="margin-right: 5px;" class="fa fa-angle-down"></i></span></td></table>';
		 			responseTruck +='<div class="'+data[j].truck_name+'"></div>';
		 			//responseTruck +=$('#paneldata').html();
	 			}
	 		//	$.LoadingOverlay("hide");
 			//	$('.report').show();
	 		}
		}
 		$('.greencount').text(scannedcount);
 		$('.orangecount').text(pendingcount);
 		$('.greycount').text(greycount);
 		$('.truckcount').html("<u><b> "+(scannedcount+pendingcount+greycount)+" TOTAL TRUCKS </b></u>")
 		
 		$('.truckdata').html(responseTruck);
 		
 		$.LoadingOverlay("hide");
 		$('.report').show();
	}else {
		$.LoadingOverlay("hide");
	}
}

$('.report').click(function(){
	var valid =false;
	var dmsLoc = $('#dmsLoc').val();
	var deliverdate= $('#orderDate').val();
	var orderDate=deliverdate.split('-');
	orderDate = orderDate[1]+'-'+orderDate[0]+'-'+orderDate[2];
	$('#dmsLocreport').val(dmsLoc);
	$('#deliveryDate').val(orderDate);
	if(typeof(filtertype) !="undefined" && filtertype !="") {
		$('#truckNumber').val("NO");
		if(filtertype=="green") {
			$('#truckarray').val(greentruckArray);
		}else if(filtertype=="orange") {
			$('#truckarray').val(orangetruckArray);
		}else {
			$('#truckarray').val(greytruckArray);
		}
	}else {
		$('#truckNumber').val("YES");
		$('#truckarray').val(truckArray);
	}
	if((typeof($('#dmsLocreport').val()) != "undefined" && $('#dmsLocreport').val() != "") && (typeof($('#orderDate').val()) != "undefined" && $('#orderDate').val() != "")) {
			valid=true;
	}
	if(!valid){
		return false;
	}else{
		$.LoadingOverlay("show");
		document.ReportForm.action = "/scanbyeachstaging/scan/report";
		document.ReportForm.method = "GET";
		document.ReportForm.submit();
		setTimeout($.LoadingOverlay("hide"), 90000);
	}
});

function onclickTruckItemdata(param) {
	$.LoadingOverlay("show");
	var dmsLoc = $('#dmsLoc').val();
	var deliverdate= $('#orderDate').val();
	var orderDate=deliverdate.split('-');
	orderDate = orderDate[1]+'-'+orderDate[0]+'-'+orderDate[2];
	var truckNumber= param.truckname;	
	if($('.'+truckNumber).html()=='') {
		console.log(truckNumber);
		var url= "https://54qe2qx889.execute-api.us-east-1.amazonaws.com/prd/itemStatusDetails?dmsLoc="+dmsLoc+"&truckNumber="+truckNumber+"&deliveryDate="+orderDate;
		 $.ajax({
			  type: 'GET',
			  url:url,
			  dataType: 'json',
		 	  contentType: 'application/json; charset=utf-8',
			  success: function(response) {
			  itemresponse=response;
			   item(itemresponse,truckNumber);
			  
			  },error: function (jqXHR, exception) {
				  $.LoadingOverlay("hide");
			  }
			});
	}else {
		var panel =  $('.'+truckNumber).find('.panel');
	    var tablehead = panel.parent().parent().find('.head_'+truckNumber);
	    if (panel.css('display') === "block") {
	    	tablehead.find('.arrowicon').html('<i class="fa fa-angle-down"></i>');
	    	tablehead.removeClass('active');
	        panel.hide();
	    } else {
	    	panel.show();
	    	tablehead.addClass('active');
	    	tablehead.find('.arrowicon').html('<i class="fa fa-angle-up"></i>');
	    }
	    $.LoadingOverlay("hide");
	}
	   
};

var itemsbeforeChange = [];
function item(itemResp, truckNum){
	var itemRespVal = itemResp.dict[truckNum];
	var responseItem="";
	responseItem +='<div class="panel" style="max-height:200px; overflow-y:scroll;"><table class="table-bordered" style="border: 1px solid;width: 82%; margin-left: 11%;"><thead style="background-color: #3b73b9;color: white;"><th>&nbsp;STOP</th><th>&nbsp;CSO</th><th>&nbsp;TRACKING</th><th>&nbsp;MODEL</th><th>&nbsp;SERIAL</th><th>&nbsp;TYPE</th><th>&nbsp;STATUS</th><th colspan="3">&nbsp;STAGING</th><th colspan="3">&nbsp;SSO</th></thead>	<tbody>';
	console.log(itemRespVal);
		if(typeof(itemRespVal) !="undefined" && itemRespVal != null && itemRespVal.length > 0) {
			for (var j=0; j<itemRespVal.length; j++) {
				console.log(itemRespVal[j].itemScanStatus);
				if(itemRespVal[j].itemScanStatus =="STAGED" || itemRespVal[j].statusCode =="CLOSED") {
					var itemsScandate=(itemRespVal[j].itemScanDate==null)?'<td>--</td>':'<td style="width: 9%;" >'+itemRespVal[j].itemScanDate+'</td>';
					var itemsscanst=(itemRespVal[j].itemScanStatus==null)?'<td>--</td>':'<td>'+itemRespVal[j].itemScanStatus+'</td>';
					
				}else {
                    var itemsScandate=(itemRespVal[j].itemScanDate==null)?'<td style="color:red;width: 9%;">--</td>':'<td style="color:red;">'+itemRespVal[j].itemScanDate+'</td>';
					var itemsscanst=(itemRespVal[j].itemScanStatus==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].itemScanStatus+'</td>';
				}
				if(itemRespVal[j].statusCode =="PICKED" || itemRespVal[j].statusCode =="CLOSED" ||itemRespVal[j].statusCode =="CANCELLED") {
					var statusCode=(itemRespVal[j].statusCode==null)?'<td>--</td>':'<td>'+itemRespVal[j].statusCode+'</td>';
						
				}else {
                    var statusCode=(itemRespVal[j].statusCode==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].statusCode+'</td>';
				}	
				if((itemRespVal[j].statusCode =="PICKED" && itemRespVal[j].itemScanStatus ==null)|| (itemRespVal[j].statusCode =="PENDING CANCEL" && itemRespVal[j].itemScanStatus =="STAGED")){
					 var stopNo=(itemRespVal[j].stopNo==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].stopNo+'</td>';
					 var orderNo=(itemRespVal[j].orderNo==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].orderNo+'</td>';
					 var trackingNumber=(itemRespVal[j].trackingNumber==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].trackingNumber+'</td>';
					 var msibSegment1=(itemRespVal[j].msibSegment1==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].msibSegment1+'</td>';
					 var serial=(itemRespVal[j].serial==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].serial+'</td>';
					 var productType=(itemRespVal[j].productType==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].productType+'</td>';
					 var notes=(itemRespVal[j].notes==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].notes+'</td>';
					 var itemsScandate=(itemRespVal[j].itemScanDate==null)?'<td style="color:red;">--</td>':'<td style="color:red;width: 9%;">'+itemRespVal[j].itemScanDate+'</td>';
					var itemsscanst=(itemRespVal[j].itemScanStatus==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].itemScanStatus+'</td>';
					var statusCode=(itemRespVal[j].statusCode==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].statusCode+'</td>';
					var sso=(itemRespVal[j].sso==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].sso+'</td>';			
				}else {
					var stopNo=(itemRespVal[j].stopNo==null)?'<td>--</td>':'<td>'+itemRespVal[j].stopNo+'</td>';
					var orderNo=(itemRespVal[j].orderNo==null)?'<td>--</td>':'<td>'+itemRespVal[j].orderNo+'</td>';
					var trackingNumber=(itemRespVal[j].trackingNumber==null)?'<td>--</td>':'<td>'+itemRespVal[j].trackingNumber+'</td>';
					var msibSegment1=(itemRespVal[j].msibSegment1==null)?'<td>--</td>':'<td>'+itemRespVal[j].msibSegment1+'</td>';
					var serial=(itemRespVal[j].serial==null)?'<td>--</td>':'<td>'+itemRespVal[j].serial+'</td>';
					var productType=(itemRespVal[j].productType==null)?'<td>--</td>':'<td>'+itemRespVal[j].productType+'</td>';
					var notes=(itemRespVal[j].notes==null)?'<td>--</td>':'<td>'+itemRespVal[j].notes+'</td>';
					var sso=(itemRespVal[j].sso==null)?'<td>--</td>':'<td>'+itemRespVal[j].sso+'</td>';
				}
				/*if(itemRespVal[j].itemScanStatus =="STAGED" || itemRespVal[j].statusCode =="CANCELLED" || itemRespVal[j].statusCode =="CLOSED") {
					var itemsScandate=(itemRespVal[j].itemScanDate==null)?'<td>--</td>':'<td>'+itemRespVal[j].itemScanDate+'</td>';
					var itemsscanst=(itemRespVal[j].itemScanStatus==null)?'<td>--</td>':'<td>'+itemRespVal[j].itemScanStatus+'</td>';
					
				}else {
                    var itemsScandate=(itemRespVal[j].itemScanDate==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].itemScanDate+'</td>';
					var itemsscanst=(itemRespVal[j].itemScanStatus==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].itemScanStatus+'</td>';
				}*/
				if((itemRespVal[j].itemScanStatus =="STAGED - DAMAGED" || itemRespVal[j].itemScanStatus =="NOT STAGED - SHORTAGE" || itemRespVal[j].itemScanStatus =="STAGED - SERIAL MIX" || itemRespVal[j].itemScanStatus =="NOT STAGED - DAMAGED")){
					 var stopNo=(itemRespVal[j].stopNo==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].stopNo+'</td>';
					 var orderNo=(itemRespVal[j].orderNo==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].orderNo+'</td>';
					 var trackingNumber=(itemRespVal[j].trackingNumber==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].trackingNumber+'</td>';
					 var msibSegment1=(itemRespVal[j].msibSegment1==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].msibSegment1+'</td>';
					 var serial=(itemRespVal[j].serial==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].serial+'</td>';
					 var productType=(itemRespVal[j].productType==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].productType+'</td>';
					 var notes=(itemRespVal[j].notes==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].notes+'</td>';
					 var itemsScandate=(itemRespVal[j].itemScanDate==null)?'<td style="color:red;">--</td>':'<td style="color:red;width: 9%;">'+itemRespVal[j].itemScanDate+'</td>';
					var itemsscanst=(itemRespVal[j].itemScanStatus==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].itemScanStatus+'</td>';
					var statusCode=(itemRespVal[j].statusCode==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].statusCode+'</td>';
					var sso=(itemRespVal[j].sso==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].sso+'</td>';
					
				}else {
					var stopNo=(itemRespVal[j].stopNo==null)?'<td>--</td>':'<td>'+itemRespVal[j].stopNo+'</td>';
					var orderNo=(itemRespVal[j].orderNo==null)?'<td>--</td>':'<td>'+itemRespVal[j].orderNo+'</td>';
					var trackingNumber=(itemRespVal[j].trackingNumber==null)?'<td>--</td>':'<td>'+itemRespVal[j].trackingNumber+'</td>';
					var msibSegment1=(itemRespVal[j].msibSegment1==null)?'<td>--</td>':'<td>'+itemRespVal[j].msibSegment1+'</td>';
					var serial=(itemRespVal[j].serial==null)?'<td>--</td>':'<td>'+itemRespVal[j].serial+'</td>';
					var productType=(itemRespVal[j].productType==null)?'<td>--</td>':'<td>'+itemRespVal[j].productType+'</td>';
					var notes=(itemRespVal[j].notes==null)?'<td>--</td>':'<td>'+itemRespVal[j].notes+'</td>';
					var itemsScandate=(itemRespVal[j].itemScanDate==null)?'<td>--</td>':'<td style="width: 9%;">'+itemRespVal[j].itemScanDate+'</td>';
					var itemsscanst=(itemRespVal[j].itemScanStatus==null)?'<td>--</td>':'<td>'+itemRespVal[j].itemScanStatus+'</td>';
					var statusCode=(itemRespVal[j].statusCode==null)?'<td>--</td>':'<td>'+itemRespVal[j].statusCode+'</td>';
					var sso=(itemRespVal[j].sso==null)?'<td>--</td>':'<td>'+itemRespVal[j].sso+'</td>';
				}
				if(itemRespVal[j].itemScanStatus =="STAGED" && (itemRespVal[j].statusCode =="CANCELLED" || itemRespVal[j].statusCode =="PENDING CANCEL")) {
					var stopNo=(itemRespVal[j].stopNo==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].stopNo+'</td>';
					 var orderNo=(itemRespVal[j].orderNo==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].orderNo+'</td>';
					 var trackingNumber=(itemRespVal[j].trackingNumber==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].trackingNumber+'</td>';
					 var msibSegment1=(itemRespVal[j].msibSegment1==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].msibSegment1+'</td>';
					 var serial=(itemRespVal[j].serial==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].serial+'</td>';
					 var productType=(itemRespVal[j].productType==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].productType+'</td>';
					 var notes=(itemRespVal[j].notes==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].notes+'</td>';
					 var itemsScandate=(itemRespVal[j].itemScanDate==null)?'<td style="color:red;">--</td>':'<td style="color:red;width: 9%;">'+itemRespVal[j].itemScanDate+'</td>';
					var itemsscanst=(itemRespVal[j].itemScanStatus==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].itemScanStatus+'</td>';
					var statusCode=(itemRespVal[j].statusCode==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].statusCode+'</td>';
					var sso=(itemRespVal[j].sso==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].sso+'</td>';
					
				}
				
				if(itemRespVal[j].statusCode =="CANCELLED" || itemRespVal[j].statusCode == "Cancelled" || itemRespVal[j].itemScanStatus == "REMOVED" || itemRespVal[j].itemScanStatus =="ADDED NOT SCANNED"){
					var stopNo=(itemRespVal[j].stopNo==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].stopNo+'</td>';
					var orderNo=(itemRespVal[j].orderNo==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].orderNo+'</td>';
					var trackingNumber=(itemRespVal[j].trackingNumber==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].trackingNumber+'</td>';
					var msibSegment1=(itemRespVal[j].msibSegment1==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].msibSegment1+'</td>';
					var serial=(itemRespVal[j].serial==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].serial+'</td>';
					var productType=(itemRespVal[j].productType==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].productType+'</td>';
					var notes=(itemRespVal[j].notes==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].notes+'</td>';
					var itemsScandate=(itemRespVal[j].itemScanDate==null)?'<td style="color:red;">--</td>':'<td style="color:red;width: 9%;">'+itemRespVal[j].itemScanDate+'</td>';
					var itemsscanst=(itemRespVal[j].itemScanStatus==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].itemScanStatus+'</td>';
					var statusCode=(itemRespVal[j].statusCode==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].statusCode+'</td>';
					var sso=(itemRespVal[j].sso==null)?'<td style="color:red;">--</td>':'<td style="color:red;">'+itemRespVal[j].sso+'</td>';				
				}

				responseItem +='<tr>';
				responseItem +=stopNo;
				responseItem +=orderNo;
				responseItem +=trackingNumber;
				responseItem +=msibSegment1;
				responseItem +=serial;
				responseItem +=productType;
				responseItem +=statusCode;
				responseItem +=itemsScandate;
				responseItem +=itemsscanst;
				responseItem +=notes;
				responseItem +=sso;
				responseItem +='</tr>';
			}
		}
		responseItem +='</tbody></table>';
		$('.'+truckNum).html(responseItem);
	    var panel =  $('.'+truckNum).find('.panel');
	    var tablehead = panel.parent().parent().find('.head_'+truckNum);
	    if (panel.css('display') === "block") {
	    	$(this).find('.arrowicon').html('<i class="fa fa-angle-down"></i>');
	    	tablehead.addClass('active');
	        panel.hide();
	    } else {
	    	panel.show();
	    	tablehead.removeClass('active');
	    	$(this).find('.arrowicon').html('<i class="fa fa-angle-up"></i>');
	    }
	    $.LoadingOverlay("hide");
};

function filtertruck(trucktype) {
	if(trucktype == "green") {
		onchangedata("ScannedFilter");
		filtertype="green";
	}else if(trucktype == "orange") {
		onchangedata("NotScannedFilter");
		filtertype="orange";
	}else {
		onchangedata("PendingFilter");
		filtertype="grey";
	}
	$('.filterbutton').show();
};

</script></div></div></form></body></html>